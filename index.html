<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Upload</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
    <div id="app">
        <h2>Upload Files</h2>
        <div class="container">
            <div class="file-input-box">
                <div class="wrapper-file-input">
                    <div class="input-box" id="openFileInput">
                        <h4>
                            <i class="fa-solid fa-upload"></i>
                            Choose File to Upload
                        </h4>
                        <input id="fileInput" type="file" hidden multiple />
                    </div>
                    <small>Files Supported: PDF, TEXT, DOC, DOCX, JPG, PNG, SVG</small>
                </div>

                <div class="wrapper-file-section">
                    <div id="fileListContainer" class="selected-files" style="display: none;">
                        <h5>Selected Files</h5>
                        <ul id="fileList" class="file-list"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const app = {
                data: {
                    selectedFileNames: []
                },
                openFileInput() {
                    document.getElementById("fileInput").click();
                },
                handleFileChange(event) {
                    const fileList = event.target.files;
                    this.data.selectedFileNames = []; // Clear previous files
                    for (let i = 0; i < fileList.length; i++) {
                        this.data.selectedFileNames.push({
                            name: fileList[i].name,
                            size: fileList[i].size
                        });
                    }
                    this.renderFileList();
                },
                formatFileSize(size) {
                    const units = ["B", "KB", "MB", "GB"];
                    let index = 0;

                    while (size >= 1024 && index < units.length - 1) {
                        size /= 1024;
                        index++;
                    }

                    return `${size.toFixed(2)} ${units[index]}`;
                },
                removeFile(index) {
                    this.data.selectedFileNames.splice(index, 1);
                    this.renderFileList();
                },
                renderFileList() {
                    const fileListContainer = document.getElementById("fileList");
                    const wrapperFileSection = document.getElementById("fileListContainer");

                    fileListContainer.innerHTML = "";

                    if (this.data.selectedFileNames.length === 0) {
                        wrapperFileSection.style.display = "none";
                        return;
                    }

                    wrapperFileSection.style.display = "block";

                    this.data.selectedFileNames.forEach((file, index) => {
                        const fileItem = document.createElement("li");
                        fileItem.className = "item";
                        fileItem.innerHTML = `
                            <span class="name">
                                ${file.name} (${this.formatFileSize(file.size)})
                            </span>
                            <div class="remove" data-index="${index}">
                                <i class="fa-solid fa-trash-can"></i>
                            </div>
                        `;
                        fileListContainer.appendChild(fileItem);
                    });

                    // Attach event listeners for remove buttons
                    document.querySelectorAll(".remove").forEach(button => {
                        button.addEventListener("click", (event) => {
                            const fileIndex = parseInt(event.currentTarget.getAttribute("data-index"), 10);
                            this.removeFile(fileIndex);
                        });
                    });
                }
            };

            // Event Listeners
            document.getElementById("openFileInput").addEventListener("click", function () {
                app.openFileInput();
            });

            document.getElementById("fileInput").addEventListener("change", function (event) {
                app.handleFileChange(event);
            });
        });
    </script>

</body>

</html>
